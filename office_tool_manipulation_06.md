# 参照用シート

## 1 少し複雑な表を作る

### 1.1 参照専用のシート

「入力規則」のリストに単語を設定すると、設定した単語だけしか入力できなくなります。このとき、直接単語を設定する以外にも、セル範囲を指定することもできるのでした。

実際に、「店」シートの商品情報は、「アイテム」シートの名前列を参照して作成しました。このような、「別の表をリスト要素にする」というのは、Excelではよく使われる手法です。

例えば、ゲームにおいて敵の行動パターンを設定することを考えます。パターンは、攻撃、仲間を呼ぶ、回復魔法、補助魔法、スキル、といった行動を確率で組み合わせて作成することとします。

それぞれの行動の詳細を、実際にそれらの行動を作成するプログラマーに伝えるには、行動の詳細を表にまとめておくと便利です。これを、「敵の行動表」とします。そして、「敵の表」の「行動パターン」列には、リスト入力規則を使って「敵の行動表」の「名前」列を指定します。

また、敵の行動がひとつの表にまとめきれない場合は、同じシートに複数の表を作ります。

このような、「他の表から参照することを目的としたシート」、つまり「参照用シート」を作ると、ゲームの仕様を管理しやすく保つことができきます。

<pre class="tnmai_assignment">
<strong>【課題１】</strong>
シートを追加して、追加したシートの名前を「敵の行動」に変更しなさい。
</pre>

<pre class="tnmai_assignment">
<strong>【課題２】</strong>
「敵の行動」シートに次の処理を行いなさい。
  1. A1セルに「補助魔法」、 B1セルに「説明」という見出しを入力
  2. A2セルに<code>-</code>(マイナス)記号、B2セルに「行動なし」と入力
  3. A11セルに「攻撃魔法・特殊攻撃」、 B11セルに「説明」という見出しを入力
  4. A12セルに<code>-</code>(マイナス)記号、B12セルに「行動なし」と入力
</pre>

<pre class="tnmai_assignment">
<strong>【課題３】</strong>
「日本の家庭用ゲーム機で初めて発売されたコマンド式RPG」では、敵の行動は「物理攻撃」、「逃走」、「補助魔法」、「攻撃魔法・特殊攻撃」に分けられます。
敵のデータとして設定できるのは「補助魔法」と「攻撃魔法・特殊攻撃」の２種類で、それぞれ４パターン(「行動なし」を含めて５パターン)から選択します。

「日本の家庭用ゲーム機で初めて発売されたコマンド式RPG」について、敵が使用する補助魔法のリストをインターネットで検索し、
名前と説明を「補助魔法」表に入力しなさい。
「補助魔法」の４パターンを入力したら、次は「攻撃魔法・特殊攻撃」のリストをインターネットで検索し、名前と説明を「攻撃魔法・特殊攻撃」表に入力しなさい。

見出しの書式を読みやすく変更し、表を枠線で囲むこと。
</pre>

### 1.3 セルの表示形式を指定する

なんらかの確率を、分数であらわしたい場合があります。例えば、RPGの敵の行動は確率によって制御されます。この確率をあらわす表を追加しましょう。

「敵の行動」シートのA21セルに「行動確率」という見出しを入力してください。次に、A22セルに`0/4`、A23セルに`1/4`と入力してください。

すると、`0/4`は入力どおりに表示されますが、`1/4`は「1月4日」に変わってしまいます。A23セルをクリックして数式バーを見ると、なんと「2025/1/4」と入力したことになっています。

<p align="center"><img alt="分数" src="images/excel_fraction.png" /></p>

これは、Excelで分数を入力すると、日付として解釈されてしまうからです。そのため、`1/4`と入力すると、自動的に「1月4日」に変換されてしまいます。この自動変換を防ぐには、表示形式を「日付にならないように設定」します。

表示形式を変更するには、「ホーム」タブの「数値」グループを使います(以前、三桁区切りの設定にも使いました)。表示形式の初期状態は「標準」で、これは「入力データをいいかんじに解釈してそれっぽく表示する」という形式です。

<p align="center"><img alt="表示形式" src="images/excel_number_formatting.png" /></p>

さて、分数を意図したように表示するには、以下の２つの方法があります。

* 表示形式を「文字列」にする: 「分数」では標準で用意されていない分母にも対応できる。約分されない。数値として認識されない。
* 表示形式を「分数」にする: 自動的に約分して表示される。「約分しない」表示はできない。

セルに入力したいデータの性質に合わせて、どちらの方法を使うかを決めます。しかし、約分されると数値の大小を比較しにくいため、大抵は「文字列」が使われます。

<pre class="tnmai_assignment">
<strong>【課題４】</strong>
A22～A25セルを選択範囲にして、表示形式を「文字列」に変更しなさい。
変更したら、A22～A25セルに、以下の分数を入力しなおしなさい。
  A22: 0/4
  A23: 1/4
  A24: 2/4
  A25: 3/4
</pre>

### 1.3 敵の表を作成する

続いて、敵の表を作成します。ゲームによりますが、RPGの敵は意外と多くのデータを持っています。すべてのデータを入力するのは時間がかかるので、本テキストでは主要データだけを入力することにします。

<pre class="tnmai_assignment">
<strong>【課題５】</strong>
シートを追加して、追加したシートの名前を「敵」に変更しなさい。
</pre>

<pre class="tnmai_assignment">
<strong>【課題６】</strong>
「敵」シートのA1～K1セルに、以下の見出しを入力しなさい
  A1: 番号
  B1: 名前
  C1: 攻撃力
  D1: 守備力
  E1: HP
  F1: 経験値
  G1: ゴールド
  H1: 補助魔法
  I1: 補助確率
  J1: 攻撃魔法・特殊攻撃
  K1: 攻魔・特攻確率

敵データには上記以外に「攻撃回避率」や「魔法ごとの回避率」がありますが、それらは入力しなくて構いません。
</pre>

<pre class="tnmai_assignment">
<strong>【課題７】</strong>
「日本の家庭用ゲーム機で初めて発売されたコマンド式RPG」について、敵の名前をインターネットで検索し、「名前」列に入力しなさい。
総数は40種類前後になると予想されます。
</pre>

<pre class="tnmai_assignment">
<strong>【課題８】</strong>
オートフィル機能を使って、「番号」列に<code>1</code>から始まる連番を入力しなさい。
行の範囲は「名前」列に合わせること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題９】</strong>
「補助魔法」列に、入力規則のリストを設定しなさい。
行の範囲は「名前」列に合わせること。
リストの値には、「敵の行動」シートのA2:A6セルを指定すること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題１０】</strong>
「補助確率」列に、入力規則のリストを設定しなさい。
行の範囲は「名前」列に合わせること。
リストの値には、「敵の行動」シートのA22:A25セルを指定すること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題１１】</strong>
「攻撃魔法・特殊攻撃」列に、入力規則のリストを設定しなさい。
行の範囲は「名前」列に合わせること。
リストの値には、「敵の行動」シートのA12:A16セルを指定すること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題１２】</strong>
「攻魔・特攻確率」列に、入力規則のリストを設定しなさい。
行の範囲は「名前」列に合わせること。
リストの値には、「敵の行動」シートのA22:A25セルを指定すること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題１３】</strong>
「攻撃力」、「守備力」、「HP」、「経験値」、「ゴールド」列に、「整数」の入力規則を設定しなさい。
行の範囲は「名前」列に合わせること。
最小値は<code>0</code>、最大値は<code>255</code>とすること。
</pre>

<pre class="tnmai_assignment">
<strong>【課題１４】</strong>
「日本の家庭用ゲーム機で初めて発売されたコマンド式RPG」について、敵のデータをインターネットで検索し、「敵」シートの表に入力しなさい。
</pre>
